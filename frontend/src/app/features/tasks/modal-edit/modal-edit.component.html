<div class="modal-overlay" (click)="close.emit()">
  <div class="modal-box" (click)="$event.stopPropagation()">

    <div class="modal-header">
      <h3>Editar Task</h3>
      <button class="btn-close" (click)="close.emit()">✕</button>
    </div>

    <div class="modal-body">

      <div class="field">
        <label>Selecione a Task</label>
        <select #taskSelect (change)="onSelectTask(taskSelect.value)">
          <option value="">— escolha uma task —</option>
          <option *ngFor="let t of tasks" [value]="t.id">
            {{ t.title }}
          </option>
        </select>
      </div>

      <ng-container *ngIf="selectedTask">
        <div class="field">
          <label>Título (somente leitura)</label>
          <input type="text" [value]="selectedTask.title" disabled />
        </div>
        <div class="field">
          <label>Descrição *</label>
          <textarea [(ngModel)]="description" rows="4"></textarea>
        </div>
        <div class="field">
          <label>Status *</label>
          <select [(ngModel)]="status">
            <option *ngFor="let opt of statusOptions" [ngValue]="opt.value">
              {{ opt.label }}
            </option>
          </select>
        </div>
      </ng-container>

      <p class="error-msg" *ngIf="error">{{ error }}</p>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="close.emit()">Cancelar</button>
      <button class="btn-primary" (click)="submit()" [disabled]="loading || !selectedTask">
        {{ loading ? 'Salvando...' : 'Salvar' }}
      </button>
    </div>

  </div>
</div>
